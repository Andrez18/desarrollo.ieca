---
import { getCollection } from 'astro:content';

const projects = await getCollection('projects')
---

<header class="flex justify-between items-center p-4 mx-17 text-white font-Poppins relative">
    <!-- Logo centrado en móvil, lado derecho en desktop -->
    <div class="flex items-center md:order-2">
        <a href="/"><img src="/logotipo.png" alt="Logo MT" class="h-12 w-auto"></a>
    </div>
    
    <!-- Botón hamburguesa -->
    <button 
        id="mobile-menu-button"
        class="md:hidden flex flex-col justify-center items-center w-8 h-8 space-y-1 focus:outline-none"
        aria-label="Menú"
    >
        <span class="w-6 h-0.5 bg-white transition-all duration-300 hamburger-line"></span>
        <span class="w-6 h-0.5 bg-white transition-all duration-300 hamburger-line"></span>
        <span class="w-6 h-0.5 bg-white transition-all duration-300 hamburger-line"></span>
    </button>
    
    <nav class="hidden md:flex items-center md:order-1">
        <ul class="list-none flex items-center space-x-2">
            <li><a href="/projects" class="text-xl hover:underline">PROYECTOS</a></li>
            <li class="text-xl">/</li>
            <li><a href="/blog" class="text-xl hover:underline">BLOG</a></li>
        </ul>
    </nav>
    
    <div class="hidden md:flex items-center space-x-2 md:order-3">
        <ul class="list-none flex items-center space-x-2">
            <li><a href="/acerca" class="text-xl hover:underline">ACERCA DE</a></li>
            <li class="text-xl">/</li>
            <span class="text-xl">PROYECTOS({projects.length})</span>
        </ul>
    </div>
    
    <div 
        id="mobile-menu" 
        class="md:hidden absolute top-full left-0 right-0 bg-black bg-opacity-95 backdrop-blur-sm transform -translate-y-full opacity-0 invisible transition-all duration-300 ease-in-out z-50"
    >
        <nav class="p-6">
            <ul class="space-y-6 text-center">
                <li><a href="/projects" class="block text-xl hover:underline transition-colors">PROYECTOS</a></li>
                <li><a href="" class="block text-xl hover:underline transition-colors">BLOG</a></li>
                <li><a href="/acerca" class="block text-xl hover:underline transition-colors">ACERCA DE</a></li>
                <li><span class="block text-xl text-gray-300">PROYECTOS({projects.length})</span></li>
            </ul>
        </nav>
    </div>
</header>

<script>
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const hamburgerLines = document.querySelectorAll('.hamburger-line');
    
    let isMenuOpen = false;
    
    mobileMenuButton?.addEventListener('click', () => {
        isMenuOpen = !isMenuOpen;
        
        if (isMenuOpen) {
            mobileMenu?.classList.remove('-translate-y-full', 'opacity-0', 'invisible');
            mobileMenu?.classList.add('translate-y-0', 'opacity-100', 'visible');
            
            hamburgerLines[0]?.classList.add('rotate-45', 'translate-y-2');
            hamburgerLines[1]?.classList.add('opacity-0');
            hamburgerLines[2]?.classList.add('-rotate-45', '-translate-y-2');
        } else {
            mobileMenu?.classList.add('-translate-y-full', 'opacity-0', 'invisible');
            mobileMenu?.classList.remove('translate-y-0', 'opacity-100', 'visible');
            
            hamburgerLines[0]?.classList.remove('rotate-45', 'translate-y-2');
            hamburgerLines[1]?.classList.remove('opacity-0');
            hamburgerLines[2]?.classList.remove('-rotate-45', '-translate-y-2');
        }
    });
    
    const mobileLinks = mobileMenu?.querySelectorAll('a');
    mobileLinks?.forEach(link => {
        link.addEventListener('click', () => {
            isMenuOpen = false;
            mobileMenu?.classList.add('-translate-y-full', 'opacity-0', 'invisible');
            mobileMenu?.classList.remove('translate-y-0', 'opacity-100', 'visible');
            
            hamburgerLines[0]?.classList.remove('rotate-45', 'translate-y-2');
            hamburgerLines[1]?.classList.remove('opacity-0');
            hamburgerLines[2]?.classList.remove('-rotate-45', '-translate-y-2');
        });
    });
    
    window.addEventListener('resize', () => {
        if (window.innerWidth >= 768 && isMenuOpen) {
            isMenuOpen = false;
            mobileMenu?.classList.add('-translate-y-full', 'opacity-0', 'invisible');
            mobileMenu?.classList.remove('translate-y-0', 'opacity-100', 'visible');
            
            // Restaurar hamburguesa
            hamburgerLines[0]?.classList.remove('rotate-45', 'translate-y-2');
            hamburgerLines[1]?.classList.remove('opacity-0');
            hamburgerLines[2]?.classList.remove('-rotate-45', '-translate-y-2');
        }
    });
</script>